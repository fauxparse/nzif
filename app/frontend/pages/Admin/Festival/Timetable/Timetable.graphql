fragment TimetableActivity on Activity {
  id
  type
  name
  slug

  ... on Workshop {
    tutors {
      ...TimetableCast
    }
  }

  ... on Show {
    directors {
      ...TimetableCast
    }
  }

  ... on SocialEvent {
    organisers {
      ...TimetableCast
    }
  }
}

fragment TimetableCast on Person {
  id
  name
  picture {
    id
    small
  }
}

fragment TimetableSlot on Slot {
  id
  startsAt
  endsAt
  activityType

  activity {
    ...TimetableActivity
  }

  venue {
    id
    room
    building
    position
  }
}

query Timetable($year: String) {
  festival(year: $year) {
    id
    startDate
    endDate

    timetable {
      id

      slots {
        ...TimetableSlot
      }
    }

    venues {
      id
      room
      building
      position
    }
  }
}

mutation CreateSlots($attributes: MultipleSlotAttributes!) {
  createSlots(attributes: $attributes) {
    slots {
      ...TimetableSlot
    }
  }
}

mutation DestroySlot($id: ID!) {
  destroySlot(id: $id)
}

mutation UpdateSlot($id: ID!, $attributes: SlotAttributes!) {
  updateSlot(id: $id, attributes: $attributes) {
    slot {
      ...TimetableSlot
    }
  }
}

mutation CreateProfile($attributes: ProfileAttributes!) {
  createProfile(attributes: $attributes) {
    profile {
      ...TimetableCast
    }
  }
}
